@model Motonet.Models.Annonce

@section Styles {
    
}

@{
    ViewBag.Title = "Details";
}

<h3>@Html.DisplayFor(model => model.Titre)</h3>

<hr />
  
<div class="row">

    <div class="col-md-12">

        <div class="col-md-3">

            <fieldset>

                <dl>

                    <dt>
                        @Html.DisplayNameFor(model => model.MotoProposee.Modele)
                    </dt>
                    <dd data-toggle="tooltip" data-html="true" title="@Model.MotoProposee.IdentificationSuite" data-placement="bottom">
                        @Html.DisplayFor(model => model.MotoProposee.Identification)
                    </dd>
                    <dt>
                        @Html.DisplayNameFor(model => model.Annee)
                    </dt>
                    <dd>
                        @Html.DisplayFor(model => model.Annee)
                    </dd>
                    <dt>
                        @Html.DisplayNameFor(model => model.Kilometrage)
                    </dt>
                    <dd>
                        @Html.DisplayFor(model => model.KilometrageAvecUnite)
                    </dd>
                    <dt>
                        @Html.DisplayNameFor(model => model.Prix)
                    </dt>
                    <dd>
                        @Html.DisplayFor(model => model.PrixAvecUnite)
                    </dd>

                </dl>

            </fieldset>


            <fieldset>

                <dl>

                    <dt>
                        @Html.DisplayNameFor(model => model.Date)
                    </dt>
                    <dd>
                        @Html.DisplayFor(model => model.Date)
                    </dd>
                    <dt>
                        @Html.DisplayNameFor(model => model.Nom)
                    </dt>
                    <dd>
                        @Html.DisplayFor(model => model.Nom)
                    </dd>
                    <dt>
                        @Html.DisplayNameFor(model => model.Departement)
                    </dt>
                    <dd>
                        @Html.DisplayFor(model => model.Departement.Nom)
                    </dd>
                    <dt>
                        @Html.DisplayNameFor(model => model.Mail)
                    </dt>
                    <dd>
                        @Html.ActionLink("Envoyer un message", "EnvoyerMailAnnonce", new { id = Model.ID })
                    </dd>
                    <dt>
                        @Html.DisplayNameFor(model => model.Telephone)
                    </dt>
                    <dd>
                        @Html.DisplayFor(model => model.Telephone)
                    </dd>

                </dl>
            </fieldset>


        </div>

        <div class="col-md-6">

            @if (Model.Photos.Any())
            {

                <fieldset class="fieldsetPhotos">

                    <div id="0" name="Vignette" style="display: block;">
                        <img src="~/Photo?id=@Model.Photos.Find(x => x.Taille == Photo.TypeTaille.Vignette && x.Principale == true).ID" alt="Photo non disponible" />
                    </div>
                    @{
                int compteur = 0;
                foreach (Photo photo in Model.Photos.FindAll(x => x.Taille == Photo.TypeTaille.Vignette && x.Principale == false))
                {
                    compteur++;
                    <div id="@compteur" name="Vignette" style="display: none;">
                        <img src="~/Photo?id=@photo.ID" alt="Photo non disponible" />
                    </div>
                }
                    }

                    <br />

                    <a href="javascript: gestionAffichageImages(0)">
                        <img src="~/Photo?id=@Model.Photos.Find(x => x.Taille == Photo.TypeTaille.Miniature && x.Principale == true).ID" alt=" photo non disponible" />
                    </a>

                    @{
                int compteur2 = 0;
                foreach (Photo photo in Model.Photos.FindAll(x => x.Taille == Photo.TypeTaille.Miniature && x.Principale == false))
                {
                    compteur2++;
                    <a href="javascript: gestionAffichageImages(@compteur2)">
                        <img src="~/Photo?id=@photo.ID" alt=" photo non disponible" />
                    </a>
                }
                    }

                </fieldset>

            }
            else
            {
                <fieldset class="fieldsetPhotos">
                    <img src="~/Content/alt.png" alt="Photo non disponible" />
                </fieldset>
            }

</div>

        <div class="col-md-3">

            <p>
                <a class="btn btn-default" href="@Url.Content("~/Annonces/Edit/" + Model.ID)">
                    <span class="glyphicon glyphicon-pencil" style="color:red;" aria-hidden="true"></span>
                    Modifier
                </a>
                <a class="btn btn-default pull-right" href="@Url.Content("~/Annonces/Delete/" + Model.ID)">
                    <span class="glyphicon glyphicon-trash" style="color:red;" aria-hidden="true"></span>
                    Supprimer
                </a>
            </p>

            @if (Model.MotosAcceptees.Any() || Model.MarquesAcceptees.Any() || Model.GenresAcceptes.Any())
            {
                <fieldset>

                    <h4>Echange possible!</h4>

                    <dl>

                        @if (Model.MotosAcceptees.Any())
                        {
                            <dt>
                                @Html.DisplayNameFor(model => model.MotosAcceptees)
                            </dt>
                            <dd>
                                <ul>
                                    @foreach (Moto moto in Model.MotosAcceptees)
                                    {
                                        <li data-toggle="tooltip" data-html="true" title="@moto.IdentificationSuite" data-placement="bottom">@moto.Identification</li>
                                    }
                                </ul>
                            </dd>
                        }

                        @if (Model.MarquesAcceptees.Any())
                        {
                            <dt>
                                @Html.DisplayNameFor(model => model.MarquesAcceptees)
                            </dt>
                            <dd>
                                <ul>
                                    @if (ViewBag.ToutesMarques)
                                    {
                                        <li>Toutes</li>
                                    }
                                    else
                                    {
                                        foreach (Marque marque in Model.MarquesAcceptees)
                                        {
                                            <li>@marque.Nom</li>
                                        }
                                    }
                                </ul>
                            </dd>
                        }

                        @if (Model.GenresAcceptes.Any())
                        {
                            <dt>
                                @Html.DisplayNameFor(model => model.GenresAcceptes)
                            </dt>
                            <dd>
                                <ul>
                                    @if (ViewBag.TousGenres)
                                    {
                                        <li>Tous</li>
                                    }
                                    else
                                    {
                                        foreach (Genre genre in Model.GenresAcceptes)
                                        {
                                            <li>@genre.Nom</li>
                                        }
                                    }
                                </ul>
                            </dd>
                        }

                    </dl>

                    <div class="text-center">
                        <a class="btn btn-default" href="@Url.Content("~/Annonces/AnnoncesCompatibles/" + Model.ID)" style="white-space: normal;">
                            <span class="glyphicon glyphicon-resize-small" style="color:red;" aria-hidden="true"></span>
                            Voir les annonces compatibles
                        </a>
                    </div>

                </fieldset>
            }

        </div>

    </div>

</div>

<div class="row">

    <div class="col-md-1">
    </div>

    <div class="col-md-10">
        <pre class="texteDescription">@Html.DisplayFor(model => model.Description)</pre>
    </div>
        
    <div class="col-md-1">
    </div>

</div>


@section Scripts{
    @Scripts.Render("~/bundles/jqueryval")

    <script type="text/javascript">

        function gestionAffichageImages(indexVignette) {

            for (var i = 0; i < document.getElementsByName('Vignette').length; i++) {
                document.getElementsByName('Vignette')[i].style.display = 'none';
            }

            document.getElementById(indexVignette).style.display = 'block';

        }

        $(document).ready(function () {
            $('[data-toggle="tooltip"]').tooltip();
        });


    </script>

}
